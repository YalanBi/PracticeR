> x <- matrix(runif(100,1,2.1),10,10)
> dimnames(x)[[1]] <- letters[1:10]
> x
      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]     [,9]    [,10]
a 1.945424 1.168886 1.425163 2.076203 1.494366 1.099698 1.155786 1.617315 1.414702 1.801596
b 1.285100 1.287558 1.290233 1.970781 1.527406 1.461933 1.517503 1.972063 1.073800 1.028978
c 1.249448 1.450439 1.950451 1.296143 1.776216 1.776858 1.840296 1.877032 1.499638 1.997847
d 1.798700 1.583873 1.545130 1.903086 1.640454 1.476409 1.409381 1.990844 2.021815 1.736971
e 1.014985 2.053038 1.754600 1.022596 1.353782 1.961206 1.772960 1.711616 1.717449 2.057336
f 1.966488 1.279954 1.456891 1.017947 1.275119 1.360980 2.002441 1.912171 2.008183 2.084371
g 1.714201 1.084412 1.056855 1.991154 1.931459 2.096366 1.907676 1.543496 1.710093 1.771152
h 1.912481 1.754133 1.410736 1.532335 1.822358 1.481298 1.415255 1.605625 1.585677 1.015426
i 2.083559 1.051369 1.522078 1.438611 1.786165 1.056381 1.091294 1.812578 2.027552 1.149433
j 1.953413 1.100585 1.401696 1.017316 1.322043 1.869844 1.714431 1.371832 1.717393 1.971013
> r.mean <- apply(x, 1, mean) #means of each row
> c.mean <- apply(x, 2, mean) #means of each column
> r.mean
       a        b        c        d        e        f        g        h        i        j 
1.519914 1.441535 1.671437 1.710666 1.641957 1.636455 1.680686 1.553532 1.501902 1.543957 
> c.mean
 [1] 1.692380 1.381425 1.481383 1.526617 1.592937 1.564097 1.582702 1.741457 1.677630 1.661412
> #Q3.7
> ind.r <- which.max(r.mean) #show the index of the maximum among the means of each row
> ind.c <- which.max(c.mean) #show the index of the maximum among the means of each column
> which.max(r.mean)
d 
4 
> which.max(c.mean)
[1] 8
> r.mean[ind.r] #show the value of the maximum among the means of each row
       d 
1.710666 
> c.mean[ind.c] #show the value of the maximum among the means of each column
[1] 1.741457
> #Q3.8
> x[ind.c]
[1] 1.912481
> x[which.max(c.mean)]
[1] 1.912481
> x[which.max(c.mean)]
[1] 1.912481
> max(apply(x, 2, mean))
[1] 1.741457
> 
> #Assignment3.2
> #Q3.6 calculate the means of each row and column
> x <- matrix(runif(100,1,2.1),20,10)
> dimnames(x)[[1]] <- letters[1:10]
Error in dimnames(x)[[1]] <- letters[1:10] : 
  length of 'dimnames' [1] not equal to array extent
> x
          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]     [,9]    [,10]
 [1,] 1.894494 1.505273 1.045364 1.958614 1.814889 1.894494 1.505273 1.045364 1.958614 1.814889
 [2,] 1.386434 1.982946 1.125304 1.788508 1.773708 1.386434 1.982946 1.125304 1.788508 1.773708
 [3,] 1.240584 2.052005 1.053333 1.245893 1.995605 1.240584 2.052005 1.053333 1.245893 1.995605
 [4,] 1.410958 1.723268 1.342201 1.695286 1.738127 1.410958 1.723268 1.342201 1.695286 1.738127
 [5,] 1.337832 1.072639 1.461656 1.782612 2.016491 1.337832 1.072639 1.461656 1.782612 2.016491
 [6,] 1.679887 1.805602 1.290128 2.038356 1.920093 1.679887 1.805602 1.290128 2.038356 1.920093
 [7,] 1.344814 1.270388 1.403126 1.762321 1.543914 1.344814 1.270388 1.403126 1.762321 1.543914
 [8,] 1.147764 1.062150 1.444646 2.069876 1.277232 1.147764 1.062150 1.444646 2.069876 1.277232
 [9,] 1.175915 1.607183 1.137264 1.419142 1.359766 1.175915 1.607183 1.137264 1.419142 1.359766
[10,] 1.731782 1.672943 1.362979 1.785908 1.514843 1.731782 1.672943 1.362979 1.785908 1.514843
[11,] 1.231791 1.683159 1.640928 1.957464 1.599021 1.231791 1.683159 1.640928 1.957464 1.599021
[12,] 1.666758 1.485228 1.179386 1.613232 2.019204 1.666758 1.485228 1.179386 1.613232 2.019204
[13,] 1.467757 1.217996 1.724743 1.604614 1.722676 1.467757 1.217996 1.724743 1.604614 1.722676
[14,] 2.068173 1.250099 1.185707 2.071490 1.625642 2.068173 1.250099 1.185707 2.071490 1.625642
[15,] 2.002173 1.679391 1.072534 1.539851 1.828962 2.002173 1.679391 1.072534 1.539851 1.828962
[16,] 1.860728 1.723715 2.085487 1.231377 1.406224 1.860728 1.723715 2.085487 1.231377 1.406224
[17,] 1.514676 1.501845 1.684870 1.119989 1.960656 1.514676 1.501845 1.684870 1.119989 1.960656
[18,] 1.809876 2.063160 1.897042 1.853907 1.273778 1.809876 2.063160 1.897042 1.853907 1.273778
[19,] 1.981873 1.481894 1.740034 1.297723 1.454361 1.981873 1.481894 1.740034 1.297723 1.454361
[20,] 1.563662 1.087178 2.017945 2.072445 1.500622 1.563662 1.087178 2.017945 2.072445 1.500622
> r.mean <- apply(x, 1, mean) #means of each row
> c.mean <- apply(x, 2, mean) #means of each column
> r.mean
 [1] 1.643727 1.611380 1.517484 1.581968 1.534246 1.746813 1.464913 1.400334 1.339854 1.613691 1.622473 1.592761
[13] 1.547557 1.640222 1.624582 1.661506 1.556407 1.779552 1.591177 1.648370
> c.mean
 [1] 1.575897 1.546403 1.444734 1.695430 1.667291 1.575897 1.546403 1.444734 1.695430 1.667291
> ind.c <- which.max(c.mean) 
> ind.c
[1] 4
> x[,ind.c]
 [1] 1.958614 1.788508 1.245893 1.695286 1.782612 2.038356 1.762321 2.069876 1.419142 1.785908 1.957464 1.613232
[13] 1.604614 2.071490 1.539851 1.231377 1.119989 1.853907 1.297723 2.072445
> which.max(x[,ind.c])
[1] 20
> maxofcol <- which.max(x[,ind.c])
> x[,ind.c]
 [1] 1.958614 1.788508 1.245893 1.695286 1.782612 2.038356 1.762321 2.069876 1.419142 1.785908 1.957464 1.613232
[13] 1.604614 2.071490 1.539851 1.231377 1.119989 1.853907 1.297723 2.072445
> x[,ind.c][-maxofcol]
 [1] 1.958614 1.788508 1.245893 1.695286 1.782612 2.038356 1.762321 2.069876 1.419142 1.785908 1.957464 1.613232
[13] 1.604614 2.071490 1.539851 1.231377 1.119989 1.853907 1.297723
> which.max(x[,ind.c][-maxofcol])
[1] 14
> x[,ind.c]
 [1] 1.958614 1.788508 1.245893 1.695286 1.782612 2.038356 1.762321 2.069876 1.419142 1.785908 1.957464 1.613232
[13] 1.604614 2.071490 1.539851 1.231377 1.119989 1.853907 1.297723 2.072445
> c(x[,ind.c],1:20)
 [1]  1.958614  1.788508  1.245893  1.695286  1.782612  2.038356  1.762321  2.069876  1.419142  1.785908  1.957464
[12]  1.613232  1.604614  2.071490  1.539851  1.231377  1.119989  1.853907  1.297723  2.072445  1.000000  2.000000
[23]  3.000000  4.000000  5.000000  6.000000  7.000000  8.000000  9.000000 10.000000 11.000000 12.000000 13.000000
[34] 14.000000 15.000000 16.000000 17.000000 18.000000 19.000000 20.000000
> ?merge
> x
          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]     [,9]    [,10]
 [1,] 1.894494 1.505273 1.045364 1.958614 1.814889 1.894494 1.505273 1.045364 1.958614 1.814889
 [2,] 1.386434 1.982946 1.125304 1.788508 1.773708 1.386434 1.982946 1.125304 1.788508 1.773708
 [3,] 1.240584 2.052005 1.053333 1.245893 1.995605 1.240584 2.052005 1.053333 1.245893 1.995605
 [4,] 1.410958 1.723268 1.342201 1.695286 1.738127 1.410958 1.723268 1.342201 1.695286 1.738127
 [5,] 1.337832 1.072639 1.461656 1.782612 2.016491 1.337832 1.072639 1.461656 1.782612 2.016491
 [6,] 1.679887 1.805602 1.290128 2.038356 1.920093 1.679887 1.805602 1.290128 2.038356 1.920093
 [7,] 1.344814 1.270388 1.403126 1.762321 1.543914 1.344814 1.270388 1.403126 1.762321 1.543914
 [8,] 1.147764 1.062150 1.444646 2.069876 1.277232 1.147764 1.062150 1.444646 2.069876 1.277232
 [9,] 1.175915 1.607183 1.137264 1.419142 1.359766 1.175915 1.607183 1.137264 1.419142 1.359766
[10,] 1.731782 1.672943 1.362979 1.785908 1.514843 1.731782 1.672943 1.362979 1.785908 1.514843
[11,] 1.231791 1.683159 1.640928 1.957464 1.599021 1.231791 1.683159 1.640928 1.957464 1.599021
[12,] 1.666758 1.485228 1.179386 1.613232 2.019204 1.666758 1.485228 1.179386 1.613232 2.019204
[13,] 1.467757 1.217996 1.724743 1.604614 1.722676 1.467757 1.217996 1.724743 1.604614 1.722676
[14,] 2.068173 1.250099 1.185707 2.071490 1.625642 2.068173 1.250099 1.185707 2.071490 1.625642
[15,] 2.002173 1.679391 1.072534 1.539851 1.828962 2.002173 1.679391 1.072534 1.539851 1.828962
[16,] 1.860728 1.723715 2.085487 1.231377 1.406224 1.860728 1.723715 2.085487 1.231377 1.406224
[17,] 1.514676 1.501845 1.684870 1.119989 1.960656 1.514676 1.501845 1.684870 1.119989 1.960656
[18,] 1.809876 2.063160 1.897042 1.853907 1.273778 1.809876 2.063160 1.897042 1.853907 1.273778
[19,] 1.981873 1.481894 1.740034 1.297723 1.454361 1.981873 1.481894 1.740034 1.297723 1.454361
[20,] 1.563662 1.087178 2.017945 2.072445 1.500622 1.563662 1.087178 2.017945 2.072445 1.500622
> x[,ind.c] <- c(x[,ind.c],1:20)
Error in x[, ind.c] <- c(x[, ind.c], 1:20) : 
  number of items to replace is not a multiple of replacement length
> x[,ind.c] <- c(x[,ind.c],1)
Error in x[, ind.c] <- c(x[, ind.c], 1) : 
  number of items to replace is not a multiple of replacement length
> x[,ind.c] <- c(x[,ind.c][-20],1)
> x
          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]     [,9]    [,10]
 [1,] 1.894494 1.505273 1.045364 1.958614 1.814889 1.894494 1.505273 1.045364 1.958614 1.814889
 [2,] 1.386434 1.982946 1.125304 1.788508 1.773708 1.386434 1.982946 1.125304 1.788508 1.773708
 [3,] 1.240584 2.052005 1.053333 1.245893 1.995605 1.240584 2.052005 1.053333 1.245893 1.995605
 [4,] 1.410958 1.723268 1.342201 1.695286 1.738127 1.410958 1.723268 1.342201 1.695286 1.738127
 [5,] 1.337832 1.072639 1.461656 1.782612 2.016491 1.337832 1.072639 1.461656 1.782612 2.016491
 [6,] 1.679887 1.805602 1.290128 2.038356 1.920093 1.679887 1.805602 1.290128 2.038356 1.920093
 [7,] 1.344814 1.270388 1.403126 1.762321 1.543914 1.344814 1.270388 1.403126 1.762321 1.543914
 [8,] 1.147764 1.062150 1.444646 2.069876 1.277232 1.147764 1.062150 1.444646 2.069876 1.277232
 [9,] 1.175915 1.607183 1.137264 1.419142 1.359766 1.175915 1.607183 1.137264 1.419142 1.359766
[10,] 1.731782 1.672943 1.362979 1.785908 1.514843 1.731782 1.672943 1.362979 1.785908 1.514843
[11,] 1.231791 1.683159 1.640928 1.957464 1.599021 1.231791 1.683159 1.640928 1.957464 1.599021
[12,] 1.666758 1.485228 1.179386 1.613232 2.019204 1.666758 1.485228 1.179386 1.613232 2.019204
[13,] 1.467757 1.217996 1.724743 1.604614 1.722676 1.467757 1.217996 1.724743 1.604614 1.722676
[14,] 2.068173 1.250099 1.185707 2.071490 1.625642 2.068173 1.250099 1.185707 2.071490 1.625642
[15,] 2.002173 1.679391 1.072534 1.539851 1.828962 2.002173 1.679391 1.072534 1.539851 1.828962
[16,] 1.860728 1.723715 2.085487 1.231377 1.406224 1.860728 1.723715 2.085487 1.231377 1.406224
[17,] 1.514676 1.501845 1.684870 1.119989 1.960656 1.514676 1.501845 1.684870 1.119989 1.960656
[18,] 1.809876 2.063160 1.897042 1.853907 1.273778 1.809876 2.063160 1.897042 1.853907 1.273778
[19,] 1.981873 1.481894 1.740034 1.297723 1.454361 1.981873 1.481894 1.740034 1.297723 1.454361
[20,] 1.563662 1.087178 2.017945 1.000000 1.500622 1.563662 1.087178 2.017945 2.072445 1.500622
> list(c(1:10),c(1:20))
[[1]]
 [1]  1  2  3  4  5  6  7  8  9 10

[[2]]
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20

> c(x[,ind.c][-1],999)
 [1]   1.788508   1.245893   1.695286   1.782612   2.038356   1.762321   2.069876   1.419142   1.785908   1.957464
[11]   1.613232   1.604614   2.071490   1.539851   1.231377   1.119989   1.853907   1.297723   1.000000 999.000000
> c(999, x[,ind.c][-1])
 [1] 999.000000   1.788508   1.245893   1.695286   1.782612   2.038356   1.762321   2.069876   1.419142   1.785908
[11]   1.957464   1.613232   1.604614   2.071490   1.539851   1.231377   1.119989   1.853907   1.297723   1.000000
> x[,ind.c][10] <- 999
> x[,ind.c]
 [1]   1.958614   1.788508   1.245893   1.695286   1.782612   2.038356   1.762321   2.069876   1.419142 999.000000
[11]   1.957464   1.613232   1.604614   2.071490   1.539851   1.231377   1.119989   1.853907   1.297723   1.000000
> ls()
 [1] "c.max"    "c.mean"   "col_"     "ind.c"    "ind.r"    "led"      "maxofcol" "n"        "on"       "prime"   
[11] "r.mean"   "r.means"  "res"      "result"   "row_"     "x"       
> geno <- read.table("genotypes.txt")
> dim(geno)
[1] 162 117
> image(geno)
Error in image.default(geno) : 'z' must be a matrix
> geno[1:10,1)]
Error: unexpected ')' in "geno[1:10,1)"
> geno[1:10,1:0]
 [1] 1 1 2 1 2 2 1 2 2 2
> geno[1:10,1:10]
      PVV4 AXR.1 HH.335C.Col DF.162L.164C.Col EC.480C EC.66C GD.86L g2395 CC.98L.Col.101C AD.121C
ind1     1     1           1                1       1      1      1     2               1       1
ind2     1     1           1                1       1      1      1     1               1       1
ind3     2     2           1                1       1      1      1     1               1       1
ind4     1     1           1                1       1      1      1     1              NA       1
ind5     2     2           2                2       2      2      2     2               2       1
ind6     2     2           2                2       2      2      2     2               2       2
ind7     1     1           1                1       1      1      1     1               1       2
ind8     2     2           2                2       1      1      1     1               1       1
ind9     2     2           2                2       2      2      2     2               2       2
ind10    2     2           2                2       2      2      2     2               2       2
> class(geno)
[1] "data.frame"
> image(as.matrix(geno))
> g2 <- apply(geno,2,as.numeric)
> class(g2)
[1] "matrix"
> dim(g2)
[1] 162 117
> g2 <- apply(geno,1,as.numeric)
> dim(g2)
[1] 117 162
> dim(t(g2))
[1] 162 117
> dim(t(t(g2)))
[1] 117 162
> ?t
> matrix(c("AA","BB","H"),10,10)
      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
 [1,] "AA" "BB" "H"  "AA" "BB" "H"  "AA" "BB" "H"  "AA" 
 [2,] "BB" "H"  "AA" "BB" "H"  "AA" "BB" "H"  "AA" "BB" 
 [3,] "H"  "AA" "BB" "H"  "AA" "BB" "H"  "AA" "BB" "H"  
 [4,] "AA" "BB" "H"  "AA" "BB" "H"  "AA" "BB" "H"  "AA" 
 [5,] "BB" "H"  "AA" "BB" "H"  "AA" "BB" "H"  "AA" "BB" 
 [6,] "H"  "AA" "BB" "H"  "AA" "BB" "H"  "AA" "BB" "H"  
 [7,] "AA" "BB" "H"  "AA" "BB" "H"  "AA" "BB" "H"  "AA" 
 [8,] "BB" "H"  "AA" "BB" "H"  "AA" "BB" "H"  "AA" "BB" 
 [9,] "H"  "AA" "BB" "H"  "AA" "BB" "H"  "AA" "BB" "H"  
[10,] "AA" "BB" "H"  "AA" "BB" "H"  "AA" "BB" "H"  "AA" 
Warning message:
In matrix(c("AA", "BB", "H"), 10, 10) :
  data length [3] is not a sub-multiple or multiple of the number of rows [10]
> apply(matrix(c("AA","BB","H"),10,10),2,as.numeric)
      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
 [1,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA
 [2,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA
 [3,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA
 [4,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA
 [5,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA
 [6,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA
 [7,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA
 [8,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA
 [9,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA
[10,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA
There were 11 warnings (use warnings() to see them)
> image(as.matrix(geno))
> image(t(as.matrix(geno)))
> image(Matrix(geno))
Error in image(Matrix(geno)) : could not find function "Matrix"
> library(Matrix)
Loading required package: lattice
> image(Matrix(geno))
Error in image(Matrix(geno)) : 
  error in evaluating the argument 'x' in selecting a method for function 'image': Error in isN0(as(m, "matrix")) : 
  (list) object cannot be coerced to type 'double'
> image(asMatrix(geno))
Error in image(asMatrix(geno)) : 
  error in evaluating the argument 'x' in selecting a method for function 'image': Error: could not find function "asMatrix"
> image(as.Matrix(geno))
Error in image(as.Matrix(geno)) : 
  error in evaluating the argument 'x' in selecting a method for function 'image': Error: could not find function "as.Matrix"
> image(matrix(geno))
Error in image.default(matrix(geno)) : 'z' must be a matrix
> geno[1:10,1:10]
      PVV4 AXR.1 HH.335C.Col DF.162L.164C.Col EC.480C EC.66C GD.86L g2395
ind1     1     1           1                1       1      1      1     2
ind2     1     1           1                1       1      1      1     1
ind3     2     2           1                1       1      1      1     1
ind4     1     1           1                1       1      1      1     1
ind5     2     2           2                2       2      2      2     2
ind6     2     2           2                2       2      2      2     2
ind7     1     1           1                1       1      1      1     1
ind8     2     2           2                2       1      1      1     1
ind9     2     2           2                2       2      2      2     2
ind10    2     2           2                2       2      2      2     2
      CC.98L.Col.101C AD.121C
ind1                1       1
ind2                1       1
ind3                1       1
ind4               NA       1
ind5                2       1
ind6                2       2
ind7                1       2
ind8                1       1
ind9                2       2
ind10               2       2
> image(as.Matrix(geno))
Error in image(as.Matrix(geno)) : 
  error in evaluating the argument 'x' in selecting a method for function 'image': Error: could not find function "as.Matrix"
> image(Matrix(geno))
Error in image(Matrix(geno)) : 
  error in evaluating the argument 'x' in selecting a method for function 'image': Error in isN0(as(m, "matrix")) : 
  (list) object cannot be coerced to type 'double'
> image(Matrix(apply(geno,2,as.numeric)))
> image(t(Matrix(apply(geno,2,as.numeric))))
> plot(1:10)
> plot(1:10,t='l')
> plot(1:10,t='o')
> points(10:1,t='l',col='red')
> png()
> png("test.png")
> plot(1:10,t='o')
> dev.off()
windows 
      2 
> getwd()
[1] "X:/Data/My Documents"
> dev.off()
png:Rplot%03d.png 
                3 
> dev.off()
null device 
          1 
> png("test.png")
> plot(1:10,t='o')
> dev.off()
null device 
          1 
> image(x)
> box()
> grid()
> abline(0,1)
> arrow(0,0.5,0.3,0.5)
Error: could not find function "arrow"
> arrows(0,0.5,0.3,0.5)
> hist(1:100)
> hist(rnorm(100))
> hist(rnorm(1000))
> hist(rnorm(1000),col="red")
> hist(rnorm(1000),col="green",add=TRUE)
> hist(rnorm(1000),col=rgb(1,0,0,0.5))
> hist(rnorm(1000),col=rgb(0,1,0,0.5),add=TRUE)
> hist(rnorm(1000),col=rgb(1,0,0,0.1))
> hist(rnorm(1000),col=rgb(0,1,0,0.1),add=TRUE)
> save.image("X:\\Data\\My Documents\\.RData")
> 
